<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login - Digital Marketing App</title>
    <!-- Note: Assuming static/css/style.css is optional or empty for this environment -->
    <style>
        /* Import Poppins font (optional, but good practice) */
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');
        
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            font-family: "Poppins", sans-serif;
            /* Animated background gradient */
            background: linear-gradient(-45deg, #0f2027, #203a43, #2c5364, #141e30);
            background-size: 400% 400%;
            animation: gradientShift 8s ease infinite;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* --- Stars --- */
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            opacity: 0.8;
            animation: shine 3s infinite ease-in-out;
            z-index: 0; /* Ensures stars are behind the card */
        }

        @keyframes shine {
            0%, 100% { opacity: 0.3; transform: scale(0.7); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        /* --- Login Card --- */
        .login-card {
            position: relative;
            z-index: 100; /* High z-index ensures it's on top */
            width: 380px;
            padding: 40px 35px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 18px;
            box-shadow: 0 0 50px rgba(0, 0, 0, 0.5), 0 0 20px rgba(37, 117, 252, 0.4);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            color: #fff;
            text-align: center;
            
            /* MODIFIED: Setting to visible state (opacity 1, scale 1) */
            opacity: 1; 
            transform: scale(1);
            transition: all 1s ease;
        }

        h1 {
            margin-bottom: 10px;
            font-size: 1.9rem;
            font-weight: 600;
            /* Gradient text effect (Updated to White/Gray) */
            background: linear-gradient(90deg, #e0e0e0, #ffffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            margin-bottom: 25px;
            opacity: 0.8;
            font-size: 0.95rem;
        }

        .form-group {
            text-align: left;
            margin-bottom: 20px;
        }

        label {
            display: block;
            font-size: 0.85rem;
            margin-bottom: 6px;
            opacity: 0.8;
        }

        input {
            width: 100%;
            padding: 12px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.25);
            background: rgba(255, 255, 255, 0.08);
            color: white;
            font-size: 1rem;
            outline: none;
            transition: all 0.3s ease;
        }

        input:focus {
            border-color: #2575fc;
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 15px rgba(37, 117, 252, 0.4);
        }

        input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .btn-primary {
            width: 100%;
            padding: 12px;
            margin-top: 10px;
            background: linear-gradient(to right, #6a11cb, #2575fc);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 15px rgba(37, 117, 252, 0.3);
        }

        .btn-primary:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(37, 117, 252, 0.4);
        }

        .error-message {
            color: #ff7b7b;
            margin-top: 15px;
            text-align: center;
            display: none;
        }

        .footer {
            position: absolute;
            bottom: 15px;
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.5);
            z-index: 1;
        }

        @media (max-width: 500px) {
            .login-card {
                width: 90%;
                padding: 30px 25px;
            }
        }
    </style>
</head>
<body>
    <!-- Background Stars -->
    <div class="star" style="top:10%; left:20%; width:3px; height:3px; animation-delay:0s;"></div>
    <div class="star" style="top:30%; left:70%; width:4px; height:4px; animation-delay:1s;"></div>
    <div class="star" style="top:60%; left:40%; width:2px; height:2px; animation-delay:1.5s;"></div>
    <div class="star" style="top:80%; left:80%; width:3px; height:3px; animation-delay:2s;"></div>
    <div class="star" style="top:50%; left:10%; width:4px; height:4px; animation-delay:2.5s;"></div>

    <!-- Login Form -->
    <div class="login-card" id="loginCard">
        <h1>Digital Marketing App</h1>
        <p class="subtitle">Admin Login</p>

        <form id="loginForm">
            <div class="form-group">
                <label for="username">Username</label>
                <input type="text" id="username" name="username" placeholder="Enter your username" required />
            </div>

            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" name="password" placeholder="Enter your password" required />
            </div>

            <button type="submit" class="btn-primary">Login</button>
        </form>

        <div id="errorMessage" class="error-message"></div>
    </div>

    <div class="footer">Â© 2025 Digital Marketing App. All rights reserved.</div>

    <!-- Motion One CDN -->
    <script src="https://cdn.jsdelivr.net/npm/motion@latest/dist/motion.js"></script>
    <script>
        // Check if Motion is available, if not, define stubs to prevent errors
        const { animate, timeline } = typeof Motion !== 'undefined' ? Motion : { animate: () => ({ finished: Promise.resolve() }), timeline: () => {} };

        // The card is now visible by default (CSS adjustment)
        // If Motion One loads, we can still use it for button effects and login animation.

        // Initial card animation is commented out to ensure visibility:
        /*
        window.addEventListener("load", () => {
             timeline([
                 ["#loginCard", { opacity: [0, 1], scale: [0.9, 1], y: [40, 0] }, { duration: 1.2, easing: "ease-out" }],
                 [".star", { opacity: [0, 1] }, { duration: 1 }]
             ]);
        });
        */

        // Button hover effect using Motion One (only if Motion is available)
        const btn = document.querySelector(".btn-primary");
        if (typeof Motion !== 'undefined') {
            btn.addEventListener("mouseenter", () => animate(btn, { scale: 1.08 }, { duration: 0.3 }));
            btn.addEventListener("mouseleave", () => animate(btn, { scale: 1.0 }, { duration: 0.3 }));
        }

        // Handle login
        document.getElementById("loginForm").addEventListener("submit", async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const submitBtn = document.querySelector(".btn-primary");
            const errorDiv = document.getElementById("errorMessage");

            submitBtn.textContent = "Logging in...";
            submitBtn.disabled = true;
            errorDiv.style.display = "none";

            try {
                // NOTE: This fetch call will only work if a backend (like Flask) is running
                // and has a /login route that returns JSON like { success: true } or { success: false, error: "..." }
                const response = await fetch("/login", {
                    method: "POST",
                    body: formData,
                });

                const result = await response.json();

                if (result.success) {
                    // Use animation for successful exit
                    if (typeof animate !== 'undefined') {
                       await animate("#loginCard", { scale: [1, 1.05, 0.9], opacity: [1, 0.8, 0] }, { duration: 0.7 }).finished;
                    }
                    window.location.href = "/dashboard";
                } else {
                    errorDiv.textContent = result.error || "Login failed: Invalid credentials.";
                    errorDiv.style.display = "block";
                    // Use animation for error shake
                    if (typeof animate !== 'undefined') {
                        animate(errorDiv, { x: [-5, 5, -5, 0] }, { duration: 0.3 });
                    }
                }
            } catch (error) {
                // Network or CORS error
                errorDiv.textContent = "Network error occurred. (Is your backend running?)";
                errorDiv.style.display = "block";
            } finally {
                submitBtn.textContent = "Login";
                submitBtn.disabled = false;
            }
        });
    </script>
</body>
</html>
